# è‚¡ç¥¨ç›‘æ§ä½¿ç”¨æŒ‡å—

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install stock-api
```

æ›´æ–° `package.json`:

```json
{
  "dependencies": {
    "puppeteer": "^23.6.1",
    "node-telegram-bot-api": "^0.64.0",
    "dotenv": "^16.4.1",
    "stock-api": "^latest",
    "dayjs": "^1.11.10"
  }
}
```

### 2. é…ç½®è‚¡ç¥¨ç›‘æ§

ç¼–è¾‘ `src/config/stock.config.js`:

```javascript
export const STOCK_CONFIG = {
    stocks: [
        {
            code: "SZ002261",           // è‚¡ç¥¨ä»£ç 
            name: "æ‹“ç»´ä¿¡æ¯",            // è‚¡ç¥¨åç§°
            cooldown: 3600000,          // å†·å´æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
            conditions: [
                {
                    type: 'below',       // æ¡ä»¶ç±»å‹
                    value: 10,           // é˜ˆå€¼
                    message: 'ğŸ’° ä»·æ ¼ä½äº 10 å…ƒ'
                },
                {
                    type: 'change_up',
                    value: 5,
                    message: 'ğŸ“ˆ æ¶¨å¹…è¶…è¿‡ 5%'
                }
            ]
        }
    ]
};
```

### 3. è¿è¡Œ

#### æ–¹å¼ 1: ç‹¬ç«‹è¿è¡Œè‚¡ç¥¨ç›‘æ§

```bash
node src/monitors/stock-monitor.js
```

#### æ–¹å¼ 2: è¿è¡Œç»Ÿä¸€ç›‘æ§ï¼ˆVPS + è‚¡ç¥¨ï¼‰

```bash
node src/monitor-all.js
```

#### æ–¹å¼ 3: å®šæ—¶ä»»åŠ¡

```bash
# äº¤æ˜“æ—¶é—´æ¯ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼ˆ9:30-15:00ï¼‰
*/5 9-15 * * 1-5 /opt/costinel/scripts/monitor-stock.sh
```

---

## æ¡ä»¶ç±»å‹è¯´æ˜

### 1. ä»·æ ¼æ¡ä»¶

#### below - ä»·æ ¼ä½äº
```javascript
{
    type: 'below',
    value: 10,
    message: 'ä»·æ ¼ä½äº 10 å…ƒ'
}
```

#### above - ä»·æ ¼é«˜äº
```javascript
{
    type: 'above',
    value: 15,
    message: 'ä»·æ ¼çªç ´ 15 å…ƒ'
}
```

#### range - ä»·æ ¼åŒºé—´
```javascript
{
    type: 'range',
    min: 9.5,
    max: 10.5,
    message: 'ä»·æ ¼è¿›å…¥ç›®æ ‡åŒºé—´'
}
```

### 2. æ¶¨è·Œå¹…æ¡ä»¶

#### change_up - æ¶¨å¹…è¶…è¿‡
```javascript
{
    type: 'change_up',
    value: 5,          // 5%
    message: 'æ¶¨å¹…è¶…è¿‡ 5%'
}
```

#### change_down - è·Œå¹…è¶…è¿‡
```javascript
{
    type: 'change_down',
    value: 5,          // 5%
    message: 'è·Œå¹…è¶…è¿‡ 5%'
}
```

---

## å®Œæ•´é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹ 1: ä»·å€¼æŠ•èµ„ç›‘æ§

```javascript
export const STOCK_CONFIG = {
    stocks: [
        {
            code: "SH600519",
            name: "è´µå·èŒ…å°",
            cooldown: 1800000,  // 30åˆ†é’Ÿ
            conditions: [
                {
                    type: 'below',
                    value: 1500,
                    message: 'ğŸ’ èŒ…å°è·Œç ´ 1500ï¼Œå¯èƒ½æ˜¯ä¹°å…¥æœºä¼š'
                },
                {
                    type: 'change_down',
                    value: 3,
                    message: 'ğŸ“‰ èŒ…å°ä¸‹è·Œè¶…è¿‡ 3%ï¼Œå…³æ³¨æ”¯æ’‘ä½'
                }
            ]
        },
        {
            code: "SZ000858",
            name: "äº”ç²®æ¶²",
            cooldown: 1800000,
            conditions: [
                {
                    type: 'range',
                    min: 140,
                    max: 150,
                    message: 'ğŸ¯ äº”ç²®æ¶²è¿›å…¥ç›®æ ‡ä¹°å…¥åŒºé—´'
                }
            ]
        }
    ]
};
```

### ç¤ºä¾‹ 2: çŸ­çº¿äº¤æ˜“ç›‘æ§

```javascript
export const STOCK_CONFIG = {
    stocks: [
        {
            code: "SZ300059",
            name: "ä¸œæ–¹è´¢å¯Œ",
            cooldown: 300000,   // 5åˆ†é’Ÿ
            conditions: [
                {
                    type: 'change_up',
                    value: 3,
                    message: 'ğŸš€ æ‹‰å‡ 3%ï¼Œæ³¨æ„è¿½é«˜é£é™©'
                },
                {
                    type: 'change_down',
                    value: 3,
                    message: 'ğŸ’¥ ä¸‹è·Œ 3%ï¼Œæ­¢æŸæˆ–åŠ ä»“'
                },
                {
                    type: 'above',
                    value: 20,
                    message: 'ğŸ“ˆ çªç ´ 20 å…ƒå‹åŠ›ä½'
                },
                {
                    type: 'below',
                    value: 18,
                    message: 'ğŸ“‰ è·Œç ´ 18 å…ƒæ”¯æ’‘ä½'
                }
            ]
        }
    ]
};
```

### ç¤ºä¾‹ 3: æ¿å—è½®åŠ¨ç›‘æ§

```javascript
export const STOCK_CONFIG = {
    stocks: [
        // ç§‘æŠ€æ¿å—
        {
            code: "SH688981",
            name: "ä¸­èŠ¯å›½é™…",
            cooldown: 1800000,
            conditions: [
                { type: 'change_up', value: 5, message: 'ğŸ”¥ èŠ¯ç‰‡æ¿å—å¼‚åŠ¨' }
            ]
        },
        // æ–°èƒ½æºæ¿å—
        {
            code: "SZ300750",
            name: "å®å¾·æ—¶ä»£",
            cooldown: 1800000,
            conditions: [
                { type: 'change_up', value: 5, message: 'âš¡ æ–°èƒ½æºæ¿å—å¯åŠ¨' }
            ]
        },
        // æ¶ˆè´¹æ¿å—
        {
            code: "SH600519",
            name: "è´µå·èŒ…å°",
            cooldown: 1800000,
            conditions: [
                { type: 'change_up', value: 3, message: 'ğŸ· æ¶ˆè´¹æ¿å—å›æš–' }
            ]
        }
    ]
};
```

---

## è¿›é˜¶æŠ€å·§

### 1. å†·å´æ—¶é—´è®¾ç½®

```javascript
// çŸ­çº¿: 5-15 åˆ†é’Ÿ
cooldown: 300000    // 5åˆ†é’Ÿ

// ä¸­çº¿: 30-60 åˆ†é’Ÿ
cooldown: 1800000   // 30åˆ†é’Ÿ

// é•¿çº¿: 2-4 å°æ—¶
cooldown: 7200000   // 2å°æ—¶
```

### 2. å¤šæ¡ä»¶ç»„åˆç­–ç•¥

```javascript
{
    code: "SZ002261",
    conditions: [
        // ä¹°å…¥ä¿¡å·
        {
            type: 'below',
            value: 9.5,
            message: 'ğŸ’° æ¥è¿‘å†å²ä½ç‚¹ï¼Œè€ƒè™‘åˆ†æ‰¹ä¹°å…¥'
        },
        {
            type: 'change_down',
            value: 5,
            message: 'ğŸ“‰ å¤§è·Œ 5%ï¼Œå¯èƒ½è¶…è·Œåå¼¹'
        },

        // å–å‡ºä¿¡å·
        {
            type: 'above',
            value: 12,
            message: 'ğŸ¯ è¾¾åˆ°ç›®æ ‡ä»·ä½ï¼Œè€ƒè™‘æ­¢ç›ˆ'
        },
        {
            type: 'change_up',
            value: 8,
            message: 'ğŸš€ æš´æ¶¨ 8%ï¼Œæ³¨æ„å›è°ƒé£é™©'
        },

        // æŒä»“è§‚å¯Ÿ
        {
            type: 'range',
            min: 10,
            max: 11,
            message: 'ğŸ“Š ä»·æ ¼åœ¨åˆç†åŒºé—´ï¼ŒæŒä»“è§‚å¯Ÿ'
        }
    ]
}
```

### 3. åˆ†çº§é€šçŸ¥

é€šè¿‡æ¶ˆæ¯å†…å®¹åŒºåˆ†é‡è¦æ€§ï¼š

```javascript
{
    // ğŸ”´ ç´§æ€¥ - éœ€è¦ç«‹å³æ“ä½œ
    message: 'ğŸ”´ ç´§æ€¥: è·Œç ´æ­¢æŸä½ 9 å…ƒ'
},
{
    // ğŸŸ¡ é‡è¦ - éœ€è¦å…³æ³¨
    message: 'ğŸŸ¡ é‡è¦: æ¥è¿‘ç›®æ ‡ä»·ä½'
},
{
    // ğŸŸ¢ æç¤º - ä»…ä¾›å‚è€ƒ
    message: 'ğŸŸ¢ æç¤º: ä»·æ ¼å°å¹…æ³¢åŠ¨'
}
```

---

## ä¸åŸè„šæœ¬å¯¹æ¯”

### åŸè„šæœ¬

```javascript
// å•ä¸€è‚¡ç¥¨
// ç¡¬ç¼–ç é˜ˆå€¼
// ç®€å•æ¡ä»¶åˆ¤æ–­
// ç¼ºå°‘é‡è¯•æœºåˆ¶

if (current_price < 10) {
    notify_telegram(message);
}
```

### æ”¹è¿›å

```javascript
// âœ… æ”¯æŒå¤šè‚¡ç¥¨
// âœ… çµæ´»é…ç½®
// âœ… å¤šç§æ¡ä»¶ç±»å‹
// âœ… è‡ªåŠ¨é‡è¯•
// âœ… å†·å´æœºåˆ¶
// âœ… å¤ç”¨ Telegram æœåŠ¡
// âœ… é”™è¯¯å¤„ç†å®Œå–„
// âœ… æ—¥å¿—è®°å½•æ¸…æ™°

const stockMonitor = new StockMonitor(STOCK_CONFIG);
await stockMonitor.run();
```

---

## å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯ 1: ä¸Šç­æ—å®šæŠ•

```javascript
// æ¯æœˆå·¥èµ„æ—¥æ£€æŸ¥ç›®æ ‡è‚¡ç¥¨ä»·æ ¼
{
    code: "SH510300",  // æ²ªæ·±300ETF
    name: "æ²ªæ·±300",
    conditions: [
        {
            type: 'below',
            value: 4.5,
            message: 'å®šæŠ•æœºä¼š: ETF ä»·æ ¼åˆé€‚'
        }
    ]
}
```

### åœºæ™¯ 2: æ­¢ç›ˆæ­¢æŸ

```javascript
{
    code: "æŒä»“è‚¡ç¥¨",
    conditions: [
        // æ­¢ç›ˆ 15%
        {
            type: 'above',
            value: ä¹°å…¥ä»· * 1.15,
            message: 'ğŸ‰ è¾¾åˆ°æ­¢ç›ˆç›®æ ‡ +15%'
        },
        // æ­¢æŸ -7%
        {
            type: 'below',
            value: ä¹°å…¥ä»· * 0.93,
            message: 'âš ï¸ è§¦å‘æ­¢æŸ -7%'
        }
    ]
}
```

### åœºæ™¯ 3: æŠ„åº•ç›‘æ§

```javascript
{
    code: "SZ002261",
    conditions: [
        {
            type: 'change_down',
            value: 5,
            message: 'æŠ„åº•æœºä¼š: ä¸‹è·Œ 5%'
        },
        {
            type: 'below',
            value: å†å²å¹³å‡ä»· * 0.9,
            message: 'æŠ„åº•æœºä¼š: ä½äºå¹³å‡ä»· 10%'
        }
    ]
}
```

---

## æ³¨æ„äº‹é¡¹

1. **äº¤æ˜“æ—¶é—´**
   - åªåœ¨ 9:30-15:00 æ‰§è¡Œæ£€æŸ¥
   - è‡ªåŠ¨è·³è¿‡å‘¨æœ«å’ŒèŠ‚å‡æ—¥

2. **å†·å´æ—¶é—´**
   - é˜²æ­¢é¢‘ç¹é€šçŸ¥
   - æ ¹æ®äº¤æ˜“é£æ ¼è°ƒæ•´

3. **API é™åˆ¶**
   - æ³¨æ„è…¾è®¯è‚¡ç¥¨ API çš„è°ƒç”¨é¢‘ç‡
   - å»ºè®®æ£€æŸ¥é—´éš” â‰¥ 5 åˆ†é’Ÿ

4. **é£é™©æç¤º**
   - ç›‘æ§å·¥å…·ä»…ä¾›å‚è€ƒ
   - ä¸æ„æˆæŠ•èµ„å»ºè®®
   - æŠ•èµ„æœ‰é£é™©ï¼Œå†³ç­–éœ€è°¨æ…

---

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ·»åŠ æ›´å¤šè‚¡ç¥¨ï¼Ÿ

```javascript
// åœ¨ stock.config.js ä¸­æ·»åŠ 
{
    code: "è‚¡ç¥¨ä»£ç ",
    name: "è‚¡ç¥¨åç§°",
    conditions: [...]
}
```

### Q: å¦‚ä½•ä¿®æ”¹æ£€æŸ¥é¢‘ç‡ï¼Ÿ

```bash
# ç¼–è¾‘ crontab
# æ¯ 5 åˆ†é’Ÿ
*/5 * * * *

# æ¯ 15 åˆ†é’Ÿ
*/15 * * * *

# æ¯å°æ—¶
0 * * * *
```

### Q: å¦‚ä½•ç¦ç”¨æŸä¸ªè‚¡ç¥¨ç›‘æ§ï¼Ÿ

```javascript
// æ–¹æ³• 1: æ³¨é‡Šæ‰
// {
//     code: "SZ002261",
//     ...
// }

// æ–¹æ³• 2: æ·»åŠ  enabled å­—æ®µ
{
    code: "SZ002261",
    enabled: false,
    ...
}
```

### Q: é€šçŸ¥å¤ªå¤šæ€ä¹ˆåŠï¼Ÿ

1. å¢åŠ  `cooldown` æ—¶é—´
2. å‡å°‘æ¡ä»¶æ•°é‡
3. æé«˜é˜ˆå€¼
4. è®¾ç½®é™éŸ³æ—¶æ®µ

```javascript
// åœ¨ monitor ä¸­æ·»åŠ é™éŸ³æ—¶æ®µæ£€æŸ¥
const hour = dayjs().hour();
if (hour >= 11 && hour <= 13) {
    console.log('åˆä¼‘æ—¶æ®µï¼Œè·³è¿‡é€šçŸ¥');
    return;
}
```

---

## ä¸‹ä¸€æ­¥æ‰©å±•

- [ ] æ”¯æŒæ›´å¤šæ•°æ®æºï¼ˆåŒèŠ±é¡ºã€ä¸œæ–¹è´¢å¯Œï¼‰
- [ ] æŠ€æœ¯æŒ‡æ ‡ç›‘æ§ï¼ˆMAã€MACDã€KDJï¼‰
- [ ] è‡ªå®šä¹‰è®¡ç®—å…¬å¼
- [ ] å†å²æ•°æ®å›æµ‹
- [ ] Web ç®¡ç†ç•Œé¢
- [ ] å¤šè´¦å·æ”¯æŒ
- [ ] åŠ å¯†è´§å¸ç›‘æ§
- [ ] å¤–æ±‡ç›‘æ§

---

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

å¦‚æœè¿™ä¸ªå·¥å…·å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™é¡¹ç›®ç‚¹ä¸ªæ˜Ÿ â­
